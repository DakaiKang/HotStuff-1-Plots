%% Figures and plots.
\usepackage{tikz,pgfplots,pgfplotstable}
\usetikzlibrary{arrows.meta}
\tikzset{
    >=Stealth,
    %dot/.style={circle,scale=0.35,draw=black,fill=black},
    node_text/.append style={font=\strut\bfseries},
    plot/.append style={baseline,scale=0.8},
    %label/.append style={font=\strut\footnotesize}
}
\pgfplotscreateplotcyclelist{mycyclelist}{
    thick,black   ,every mark/.append style={solid,fill=\pgfplotsmarklistfill},mark=*\\
    thick,red     ,every mark/.append style={solid,fill=\pgfplotsmarklistfill},mark=square*\\
    thick,blue    ,every mark/.append style={solid,fill=\pgfplotsmarklistfill},mark=triangle*\\
    thick,teal    ,every mark/.append style={solid,fill=\pgfplotsmarklistfill},mark=pentagon*\\
    thick,brown   ,every mark/.append style={solid,fill=\pgfplotsmarklistfill},mark=halfsquare*\\
    thick,orange  ,every mark/.append style={solid,fill=\pgfplotsmarklistfill},mark=halfcircle*\\
    thick,violet  ,every mark/.append style={solid,fill=\pgfplotsmarklistfill,rotate=180},mark=halfdiamond*\\
}
\pgfplotscreateplotcyclelist{mycyclelistex}{
    black   ,every mark/.append style={solid,fill=\pgfplotsmarklistfill},mark=*\\
    red     ,every mark/.append style={solid,fill=\pgfplotsmarklistfill},mark=square*\\
}

\pgfplotsset{
 tick label style={font=\Large},
 legend style={font=\LARGE,cells={anchor=west}},
 title style={font=\Large},
 label style={font=\LARGE},
 width=262.5pt,
 height=185pt,
%scaled y ticks = false,
every axis/.append style={
        %ylabel near ticks,
        xlabel near ticks,
        mark size=2.5pt,
        cycle list name=mycyclelist,
        % font=\Large,
        y tick label style={
                %/pgf/number format/precision=1,
                %/pgf/number format/fixed,
                %/pgf/number format/fixed zerofill
            }
    },
barstyle/.append style={
        ybar,
       bar width={0.5cm},
        enlarge x limits=0.4,
        enlarge y limits={upper=0.025},
        ymin=0,
        xtick=data
    }
every axis/.append style={
ylabel near ticks,
xlabel near ticks,
mark size=1pt,
cycle list name=mycyclelist,
 font=\Large,
enlargelimits=0.1
},
}

\pgfplotsset{select coords index/.style n args={2}{
    x filter/.code={
        \ifnum\coordindex<#1\def\pgfmathresult{}\fi
        \ifnum\coordindex>#2\def\pgfmathresult{}\fi
    }
}}

\definecolor{colAA}{RGB}{255,87,51}
\definecolor{colAB}{RGB}{255,116,51}
\definecolor{colBA}{RGB}{53,142,250}
\definecolor{colBB}{RGB}{147,199,251}
\definecolor{colCA}{RGB}{92,208,48}
\definecolor{colCB}{RGB}{167,252,105}
\definecolor{colDA}{RGB}{214,217,60}
\definecolor{colDB}{RGB}{242,245,52}
\definecolor{colEA}{RGB}{242,84,228}
\definecolor{colEB}{RGB}{223,128,216}
\definecolor{colFA}{RGB}{159,28,249}
\definecolor{colGA}{RGB}{28,71,249}

    

\newcommand{\throughputgraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1,
        grid=major,  xmin={0}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}}


\newcommand{\throughputgraphb}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0},xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={1},legend columns=-1, legend to name={mainlegend4}, 
        grid=major, xmin={0}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
        \legend{\HS{}, \HSTwo{}, \sysname{} , \sysname{} (with slotting)}
    \end{axis}
\end{tikzpicture}}

\newcommand{\geothroughputgraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0},xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={1},legend columns=-1, legend to name={mainlegend4}, 
        grid=major, xmin={1.5}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
        \legend{\HS{}, \HSTwo{}, \sysname{} , \sysname{} (with slotting)}
    \end{axis}
\end{tikzpicture}}

\newcommand{\latencygraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0}, xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, ymax={20},
        grid=major, xmin={0}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}}

\newcommand{\geolatencygraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0}, xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, ymax={4},
        grid=major, xmin={1.5}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}}

\newcommand{\nonresponsivegraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0},xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, 
        grid=major,  xmin={-1}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}}

\newcommand{\nonresponsivegraphb}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0},xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, 
        grid=major,  xmin={-1}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={PlaceHolder}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}}


\newcommand{\nonresponsivelatgraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0},xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, ymax={200},
        grid=major,  xmin={-1}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}}

\newcommand{\nonresponsivelatgraphb}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0},xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, ymax={200},
        grid=major,  xmin={-1}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={PlaceHolder}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}}


\newcommand{\crashgraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, 
        grid=major,  xmin={-1}, width=200, height=140,legend to name={crashlegend}]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT10}] {#1};
        \addplot table[x={n},y={HS-1-SLOT100}] {#1};
        \addplot table[x={n},y={Zyzzyva}] {#1};
        \legend{\HS{}, \HSTwo{}, \HSOne{}, \HSOne{} (10ms-slotting), HotStuff-1 (100ms-slotting), Zyzzyva}
    \end{axis}
\end{tikzpicture}}

\newcommand{\crashlatgraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=1},xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, ytick={10, 100, 1000}, yticklabels={$10^1$, $10^2$, $10^3$},
        ymode=log, % Use log scale for y-axis
        log basis y=10, % Base 10 for logarithmic scale
        grid=major,  xmin={-1}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT10}] {#1};
        \addplot table[x={n},y={HS-1-SLOT100}] {#1};
        \addplot table[x={n},y={Zyzzyva}] {#1};
    \end{axis}
\end{tikzpicture}}


\newcommand{\forktailgraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0},xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, 
        grid=major,  xmin={-1}, width=200, height=140,legend to name={falegend}]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT10}] {#1};
        \addplot table[x={n},y={HS-1-SLOT100}] {#1};
        \legend{\HS{}, \HSTwo{}, \HSOne{}, \HSOne{} (10ms-slotting), \HSOne{} (100ms-slotting)}
    \end{axis}
\end{tikzpicture}}

\newcommand{\forktaillatgraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0},xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0},legend columns=-1, 
        grid=major,  xmin={-1}, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT10}] {#1};
        \addplot table[x={n},y={HS-1-SLOT100}] {#1};
    \end{axis}
\end{tikzpicture}}


\newcommand{\batchsizegraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=1}, xlabel={#3},ylabel={#4},title={#2},symbolic x coords={#5}, ymin={0},legend columns=-1,
        grid=major, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}}

\newcommand{\batchsizeLatgraph}[5]{\begin{tikzpicture}[plot, scale=1.2]
    \begin{axis}[yticklabel style={/pgf/number format/precision=0}, xlabel={#3},ylabel={#4},title={#2},symbolic x coords={#5}, ymin={0},legend columns=-1, ymax={120},
        grid=major, width=200, height=140]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}}


\newcommand{\resultgraphtputlatb}[5]{\begin{tikzpicture}[plot, scale=2]
    \begin{axis}[xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0}, legend columns=-1, ymin={0},
        grid=major, width=200, height=140]
        \addplot table[x={THS},y={LHS}] {#1};
        \addplot table[x={THS-2},y={LHS-2}] {#1};
        \addplot table[x={THS-1},y={LHS-1}] {#1};
        \addplot table[x={THS-1-SLOT},y={LHS-1-SLOT}] {#1};
        % \addplot table[x={TPBFT},y={LPBFT}] {#1};
        % \addplot table[x={TRCC},y={LRCC}] {#1};
        % \addplot table[x={THS-1+MDLG},y={LHS-1+MDLG}] {#1};
        % \addplot[color=cyan,mark=x] table[x={THS-1+Both},y={LHS-1+Both}] {#1};
    \end{axis}
\end{tikzpicture}}

\newcommand{\resultgraphtputlatc}[5]{\begin{tikzpicture}[plot, scale=2]
    \begin{axis}[xlabel={#3},ylabel={#4},title={#2},xtick={#5}, ymin={0}, legend columns=-1, ymin={0},
        grid=major, width=200, height=140]
        \addplot table[x={THS},y={LHS}] {#1};
        \addplot table[x={THS-2},y={LHS-2}] {#1};
        \addplot table[x={THS-1},y={LHS-1}] {#1};
        \addplot table[x={THS-1-SLOT},y={LHS-1-SLOT}] {#1};
        % \addplot table[x={TPBFT},y={LPBFT}] {#1};
    \end{axis}
\end{tikzpicture}}

\newcommand{\networkdelaytesttput}[4]{%
\begin{tikzpicture}[plot, scale=1]
    \begin{axis}[
        title={#2},
        xlabel={#3},
        ylabel={#4},
        xtick={0, 10, 11, 20, 21, 31},
        xticklabels={0, $\,\,10\,\,11$, , $\,\,20\,\,21$, ,31},
        ymode=log,
        log basis y=10,
        ytick={1,10,100,1000,10000,100000}, % 你可以根据数据范围调整
        yticklabels={$10^0$, $10^1$, $10^2$, $10^3$, $10^4$, $10^5$},
        grid=major,
        scaled x ticks=false,
        width=190,
        height=140,
        legend columns=-1,
        legend to name={networkdelaylegend},
    ]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
        \legend{HotStuff, HS-2, \sysname{}, \sysname{} (with slotting)}
    \end{axis}
\end{tikzpicture}%
}


\newcommand{\networkdelaytestlat}[4]{%
\begin{tikzpicture}[plot, scale=1]
    \begin{axis}[
        title={#2},
        xlabel={#3},
        ylabel={#4},
        xtick={0, 10, 11, 20, 21, 31},
        xticklabels={0, $\,\,10\,\,11$, , $\,\,20\,\,21$, ,31}, % Adjust specific tick labels as needed
        % extra x ticks={11, 21}, % Add extra ticks for better spacing
        % extra x tick style={grid=major},
        % ymin={50}, % Set a positive ymin for log scale
        % ymode=log, % Use log scale for y-axis
        % log basis y=10, % Base 10 for logarithmic scale
        grid=major,
        scaled x ticks=false, % Ensure x-axis reflects proportional spacing
        width=200,
        height=140,
        legend columns=-1
    ]
        \addplot table[x={n},y={HS}] {#1};
        \addplot table[x={n},y={HS-2}] {#1};
        \addplot table[x={n},y={HS-1}] {#1};
        \addplot table[x={n},y={HS-1-SLOT}] {#1};
    \end{axis}
\end{tikzpicture}%
}









\newcommand{\axistput}{Throughput (\si{\txn\per\second})}
\newcommand{\axislat}{Latency (\si{\second})}
\newcommand{\axisnodes}{Number of replicas ($\n$)}
\newcommand{\axisregions}{Number of regions}
\newcommand{\axisbandwidth}{Network Bandwidth (Mbit/s)}
\newcommand{\axiscore}{Number of CPU Cores}
\newcommand{\axisinstances}{Number of concurrent instances}
\newcommand{\axisfailures}{Number of faulty replicas}
\newcommand{\axisbfailures}{Number of faulty replicas}
\newcommand{\axispercentage}{Ratio of faulty replicas (out-of-$\f$)}
\newcommand{\axisbpercentage}{Ratio of faulty failures (out-of-$\f$)}
\newcommand{\axisbatches}{Batch size}
\newcommand{\axistxnsize}{Transaction size ($\si{\byte}$)}
\newcommand{\axisinflight}{Client Batches per Primary receives}
\newcommand{\axisticksnodes}{16,32,64}
\newcommand{\axisticksbatches}{100,1000,2000,5000,10000}
\newcommand{\axisticksinstances}{1,8,16,32,64}
\newcommand{\axisticksinstancesb}{1,16,32,64,128}
\newcommand{\axisticksfailures}{0,1,2,3,4,6,8,10}
\newcommand{\axistickspercentage}{0,0.2,0.4,0.6,0.8,1}
\newcommand{\axistickstxnsize}{48,200,400,600,800,1600}
\newcommand{\axistickstput}{0,500000,1000000,1500000,2000000,2500000,3000000,3500000,4000000,4500000}
\newcommand{\axisticksinflight}{12, 25, 50, 100, 200}
\newcommand{\axisticksregions}{2, 3, 4, 5}
\newcommand{\axisticksbandwidth}{500, 1000, 2000, 3000, 4000}
\newcommand{\axistickslows}{0,1,4,7,10}
\newcommand{\axislows}{Number of Slow Replicas}

\newcommand{\axisticksnodesb}{4,16,32,64}

\newcommand{\axisnumadaptive}{Maximal Number of Adaptive Blocks}
\newcommand{\axisticksnumadaptive}{0, 10, 20, 50, 100}


\newcommand{\axisnumslot}{Number of slots per round}
\newcommand{\axisticksnumslot}{1, 5, 10, 20, 32}